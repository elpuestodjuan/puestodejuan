<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>El puesto de Juan - Frutas y Verduras</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Frutas y verduras frescas, directo del productor a tu mesa. Pedí productos seleccionados. Envíos a domicilio en Canelones, Uruguay.">
  <meta name="keywords" content="frutas, verduras, frescas, chacra, directo, productor, canelones, uruguay, natural, productos, envío, domicilio">
  <meta name="author" content="El puesto de Juan">
  <meta name="theme-color" content="#8afc4d">
  <link rel="icon" href="img/favicon.png" sizes="32x32" type="image/png">
  <link rel="apple-touch-icon" href="img/apple-touch-icon.png">
  <link rel="manifest" href="site.webmanifest">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css?family=Montserrat:700|Open+Sans:400,600,700&display=swap" rel="stylesheet">
  <style>
    :root {
      --verde-manzana: #8afc4d;
      --verde-manzana-dark: #6ad135;
      --verde-manzana-light: #bfff8d;
      --negro: #1a1a1a;
      --gris: #232323;
      --blanco: #fff;
      --sombra: 0 8px 32px #000b;
    }
    html { scroll-behavior: smooth; }
    body { font-family: 'Open Sans', Arial, sans-serif; background: var(--negro); margin: 0; color: var(--blanco);}
    nav { background: var(--verde-manzana); color: var(--negro); box-shadow: 0 2px 10px #2228; position: sticky; top: 0; z-index: 100; }
    .navbar-container { display: flex; align-items: center; justify-content: space-between; max-width: 1200px; margin: 0 auto; padding: 0.7em 1.3em; position: relative;}
    .navbar-logo { display: flex; align-items: center; gap: 0.7em;}
    .navbar-logo img { height: 52px; margin-right: 0.7em; filter: drop-shadow(0 2px 12px #6ad13570);}
    .navbar-title { font-family: 'Montserrat', Arial, sans-serif; font-weight: 900; font-size: 1.45em; letter-spacing: .02em; color: var(--negro);}
    .navbar-menu { list-style: none; display: flex; gap: 1.3em; margin: 0; padding: 0; }
    .navbar-menu li a { color: var(--negro); text-decoration: none; font-weight: 650; font-size: 1.13em; padding: 0.2em 0.6em; border-radius: 5px; transition: background 0.17s;}
    .navbar-menu li a.active, .navbar-menu li a:hover { background: var(--verde-manzana-light); color: var(--negro);}
    .navbar-burger {
      display: none; flex-direction: column; justify-content: center; align-items: center;
      width: 44px; height: 44px; background: none; border: none; cursor: pointer;
      position: relative; z-index: 200;
    }
    .navbar-burger:focus { outline: 2px solid var(--negro);}
    .navbar-burger-bar {
      width: 26px; height: 3px; background: var(--negro); border-radius: 3px;
      margin: 3px 0; transition: 0.32s cubic-bezier(.55,0,.1,1);
    }
    .navbar-burger.open .navbar-burger-bar:nth-child(1) { transform: translateY(6px) rotate(45deg);}
    .navbar-burger.open .navbar-burger-bar:nth-child(2) { opacity: 0; }
    .navbar-burger.open .navbar-burger-bar:nth-child(3) { transform: translateY(-6px) rotate(-45deg);}
    @media (max-width: 900px) {
      .navbar-menu {
        position: absolute; top: 100%; left: 0; right: 0;
        flex-direction: column; gap: 0.1em; background: var(--verde-manzana);
        box-shadow: 0 5px 22px #6ad13533;
        padding: 0.6em 0 0.5em 0;
        max-height: 0; overflow: hidden; transition: max-height 0.32s cubic-bezier(.55,0,.1,1);
        border-bottom-left-radius: 10px; border-bottom-right-radius: 10px;
      }
      .navbar-menu.open { max-height: 320px; transition: max-height 0.46s cubic-bezier(.22,1,.36,1.1);}
      .navbar-burger { display: flex; }
    }
    @media (max-width: 510px) {
      .navbar-logo img { height: 38px;}
      .navbar-title { font-size: 1em;}
    }
    .container { max-width: 1200px; margin: 0 auto; padding: 1.2em 1.4em; }
    #inicio { text-align: center; display: flex; flex-direction: column; align-items: center; }
    .hero-titulo {
      display: block; font-family: 'Montserrat', Arial, sans-serif;
      font-size: 2.4em; font-weight: 900; color: var(--verde-manzana);
      margin: 1.6em 0 0.7em 0;
      text-shadow: 0 5px 36px #6ad13555, 0 1.5px 0 #232323, 0 0 10px #8afc4d79;
      letter-spacing: 0.01em;
      position: relative;
      animation: sombraBrilla 2s ease-in-out infinite alternate;
    }
    #heroTitulo { transition: opacity 0.4s; }
    @keyframes sombraBrilla {
      0% { text-shadow: 0 5px 36px #6ad1353a, 0 1.5px 0 #232323, 0 0 10px #8afc4d46;}
      80% { text-shadow: 0 8px 40px #8afc4d80, 0 2.5px 0 #232323, 0 0 20px #bfff8d;}
      100% { text-shadow: 0 10px 52px #bfff8d, 0 3.5px 0 #232323, 0 0 32px #8afc4d;}
    }
    .wavy { display: inline-block; animation: wavy 2.4s infinite linear; will-change: filter;}
    @keyframes wavy {
      0%,100% { filter: brightness(1);}
      47% { filter: brightness(1.23) drop-shadow(0 4px 16px #8afc4dc8);}
      53% { filter: brightness(1.19) drop-shadow(0 6px 32px #bfff8d);}
    }
    .hero-image {
      display: block;
      margin: 2em auto 1.8em auto;
      max-width: 400px;
      width: 92vw;
      border-radius: 18px;
      box-shadow: var(--sombra);
      border: 1px solid var(--verde-manzana-dark);
    }
    #inicio p { font-size:1.09em; max-width:660px; line-height:1.5; margin:0 auto; }
    h2 { color: var(--verde-manzana); font-family: 'Montserrat', Arial, sans-serif; margin-top: 2.1em; font-size:2em;}
    #galeria-productos { display: flex; flex-wrap: wrap; gap: 1.6em; justify-content: flex-start; margin-top: 1.6em;}
    .producto-card {
      border: 2px solid var(--verde-manzana);
      border-radius: 15px;
      width: 215px;
      padding: 1.2em 1em 1.4em 1em;
      text-align: center;
      background: linear-gradient(140deg, var(--gris) 80%, var(--verde-manzana-dark) 100%);
      box-shadow: 0 2px 10px #8afc4d22;
      transition: box-shadow .26s, transform .19s, border-color .18s;
      display: flex; flex-direction: column; align-items: center; color: var(--blanco);
      position: relative;
    }
    .producto-card:hover {
      box-shadow: 0 10px 28px #8afc4d55, 0 1.5px 0 #232323;
      border-color: var(--verde-manzana-light);
      transform: translateY(-2px) scale(1.028);
      z-index:3;
    }
    .producto-card img {
      width: 100%; max-height: 120px; object-fit: cover; border-radius: 10px; margin-bottom: 0.7em; border: 1.5px solid var(--verde-manzana-dark);
      background: var(--negro);
      box-shadow: 0 4px 16px #8afc4d25;
    }
    .producto-card h3 { margin: 0.2em 0 0.5em 0; font-size: 1.16em;}
    .producto-card .precio { color: var(--verde-manzana); font-weight: bold; font-size: 1.22em;}
    .producto-card .comentarios { font-size: 0.99em; margin: 0.4em 0;}
    .producto-card .agregar-btn {
      background: var(--verde-manzana-dark); color: var(--negro); border: none; border-radius: 6px; padding: 0.53em 1.25em;
      font-size: 1.09em; cursor: pointer; margin-top: 0.7em; font-weight: 700; box-shadow: 0 2px 10px #8afc4d11;
      transition: background 0.18s, color 0.18s, box-shadow .21s, transform .17s;
    }
    .producto-card .agregar-btn:active {
      background: var(--verde-manzana-light); color: var(--negro); transform: scale(0.96); box-shadow: 0 1px 5px #8afc4d55;
    }
    .producto-card .agregar-btn:hover {
      background: #bfff8d; color: var(--negro); box-shadow: 0 6px 22px #8afc4d88;
    }
    .ventajas-grid { display: flex; gap: 1.8em; margin: 2em 0 1em 0; flex-wrap: wrap; justify-content: flex-start;}
    .ventaja-card {
      background: linear-gradient(135deg, var(--gris) 80%, var(--verde-manzana-dark) 100%);
      border: 2px solid var(--verde-manzana);
      border-radius: 14px;
      box-shadow: 0 2px 12px #8afc4d22;
      padding: 1.5em 1.2em; text-align: center; width: 250px; color: var(--blanco);
      transition: box-shadow .19s, transform .15s, border-color .18s;
      display: flex; flex-direction: column; align-items: center;
    }
    .ventaja-card img {
      width: 65px; height: 65px; border-radius: 50%; object-fit: cover; margin-bottom: 1em;
      box-shadow: 0 2px 12px #8afc4d22; border: 2px solid var(--verde-manzana-dark); background: var(--negro);
    }
    .ventaja-card h4 {
      margin: 0.5em 0 0.3em 0; font-size: 1.22em; color: var(--verde-manzana); font-family: 'Montserrat', Arial, sans-serif; font-weight: bold; letter-spacing: 0.01em;
    }
    .ventaja-card p { font-size: 1.04em; color: #e0ffe4; margin: 0; line-height: 1.4;}
    .contact-row { display: flex; gap: 2em; margin-top: 2em; }
    .contact-info { min-width: 270px; }
    .contact-info ul { list-style: none; padding: 0; margin: 0; }
    .contact-info li { margin-bottom: 0.8em; display: flex; align-items: center; gap: 0.5em;}
    .contact-form { display: flex; flex-direction: column; min-width: 250px; max-width: 400px; width:100%; gap: 0.65em; background: var(--gris); border-radius: 12px; padding: 1.2em 1.3em;}
    .contact-form input, .contact-form textarea {
      border: 1.5px solid var(--verde-manzana-dark); border-radius: 5px; padding: 0.5em 0.7em; font-size: 1.03em;
      margin-bottom: 0.3em; background: var(--negro); color: var(--blanco); resize: none;
    }
    .contact-form button {
      background: var(--verde-manzana-dark); color: var(--negro); font-weight: bold; border: none; border-radius: 6px;
      padding: 0.6em 1.3em; font-size: 1.1em; cursor: pointer; margin-top: 0.5em; transition: background 0.18s;
    }
    .contact-form button:hover { background: var(--verde-manzana-light);}
    #contact-status { min-height: 1.3em; font-size: 0.97em; color: var(--verde-manzana);}
    footer { margin-top:3em; background:var(--verde-manzana); color:var(--negro); text-align:center; padding:1.2em; }
    #cart-floating-btn {
      position:fixed;bottom:24px;right:24px;z-index:999;
      background:var(--verde-manzana);color:var(--negro);border:none;border-radius:50%;
      width:56px;height:56px;font-size:2em;box-shadow:0 2px 12px #8afc4d66;cursor:pointer;
      display: flex; align-items: center; justify-content: center;
      transition: background .18s, transform .17s;
      outline: 2px solid var(--verde-manzana-light);
    }
    #cart-floating-btn.cart-anim { animation: cartPop 0.42s;}
    @keyframes cartPop {
      0% { transform: scale(1);}
      30% { transform: scale(1.18);}
      70% { transform: scale(0.90);}
      100% { transform: scale(1);}
    }
    #cart-count {
      font-size:0.7em;position:absolute;right:10px;top:10px;
      background:var(--negro);color:var(--verde-manzana);border-radius:50%;padding:2px 7px;font-weight:bold;
    }
    #cart-panel {
      display:none;position:fixed;bottom:0;right:0;width:340px;
      background:var(--gris);box-shadow:-4px 0 24px #8afc4d55;z-index:1100;
      padding:1.2em 1.5em;border-radius:16px 16px 0 0;
      font-family: 'Open Sans',Arial,sans-serif; color:var(--blanco);
    }
    #cart-panel-close {
      position:absolute;top:8px;right:14px;font-size:2em;background:none;border:none;color:var(--verde-manzana);cursor:pointer;
    }
    #cart-list { min-height: 48px; margin-bottom: 1em;}
    #cart-list .item-row {
      display: flex; justify-content: space-between; align-items: center;
      padding: 0.4em 0; border-bottom: 1px solid var(--verde-manzana);
    }
    #cart-list .item-row:last-child { border-bottom: none; }
    .cart-remove, .cart-minus, .cart-plus {
      background: none; border: none; color: var(--verde-manzana); font-size: 1.2em; cursor: pointer; margin: 0 0.2em;
    }
    .cart-minus, .cart-plus { color: var(--verde-manzana-dark);}
    #cart-total-row { display:flex;justify-content:space-between;font-weight:bold;margin:1em 0;}
    #cart-panel-form input[type="text"] {
      width: 100%; padding: 0.4em 0.6em; margin-bottom:0.6em; border:1px solid var(--verde-manzana-dark); border-radius:5px; background:var(--negro); color:var(--blanco);
    }
    #cart-panel-form input[type="radio"] {
      width: 1.2em; height: 1.2em; accent-color: #8afc4d; outline: none; margin-right: 0.3em;
    }
    #cart-panel-form label[for="pago-efectivo"], #cart-panel-form label[for="pago-debito"] {
      cursor:pointer;font-size:1.13em;color:var(--verde-manzana);margin-right:1.8em;display:inline-flex;align-items:center;
    }
    .cart-pay-btn {
      background:var(--verde-manzana-dark);color:var(--negro);padding:0.7em 1.4em;border:none;border-radius:5px;font-size:1.08em;cursor:pointer;margin-top:0.5em; font-weight:bold; display:block; width:100%;
      transition: background 0.17s;
    }
    .cart-pay-btn:hover {
      background: var(--verde-manzana-light);
      color: var(--negro);
    }
    #explicativo-flotante {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      z-index: 1500;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(34, 34, 34, 0.82);
      transition: opacity 0.25s;
    }
    #explicativo-flotante.oculto {
      opacity: 0; pointer-events: none;
    }
    .explicativo-box {
      background: var(--negro);
      border-radius: 15px;
      padding: 2.1em 2em 2em 2em;
      box-shadow: 0 8px 36px #23232388;
      max-width: 415px; width: 95vw;
      text-align: left;
      position: relative;
      font-family: 'Open Sans', Arial, sans-serif;
      animation: popIn 0.5s;
      border: 2.5px solid var(--verde-manzana);
    }
    @keyframes popIn {
      0% { transform: scale(0.88); opacity: 0;}
      100% { transform: scale(1); opacity: 1;}
    }
    .explicativo-box h2 {
      margin-top: 0;
      font-size: 1.6em;
      color: var(--verde-manzana);
      font-family: 'Montserrat', Arial, sans-serif;
      margin-bottom: 0.4em;
      letter-spacing: .01em;
    }
    .explicativo-box ul {
      margin: 0 0 0.7em 0;
      padding-left: 1.3em;
      color: var(--blanco);
      font-size: 1.10em;
    }
    .explicativo-box li {
      margin-bottom: .5em;
      line-height: 1.5;
    }
    .explicativo-cerrar {
      position: absolute; top: 9px; right: 15px;
      background: none; border: none;
      font-size: 2em; color: var(--verde-manzana-dark);
      cursor: pointer; line-height: 1;
      transition: color 0.2s;
    }
    .explicativo-cerrar:hover { color: var(--verde-manzana); }
    @media (max-width: 1000px) {
      .container { max-width: 97vw; padding: 1em 0.6em; }
      .navbar-container { max-width: 97vw; padding:0.7em 0.6em; }
      .ventajas-grid, #galeria-productos { gap: 1em; }
      .ventaja-card { width: 210px; }
      .producto-card { width: 180px; }
    }
    @media (max-width: 700px) {
      .container { padding: 1em 0.3em; }
      .navbar-container { flex-direction: column; gap: 0.7em; }
      .navbar-menu { flex-direction: column; gap: 0.4em; align-items: flex-start; width: 100%; }
      .navbar-logo { justify-content: center; width: 100%; }
      .navbar-title { font-size: 1.1em; }
      #galeria-productos, .ventajas-grid { justify-content: center; }
      .ventaja-card, .producto-card { width: 96vw; max-width: 330px; }
      #cart-panel { width: 99vw; left:0; right:0; padding:1.2em 0.5em; }
      .contact-row { flex-direction: column; gap: 1.2em; }
      .contact-info, .contact-form { min-width: 0; width: 100%; max-width: 100vw; }
      .contact-form, .contact-info { padding: 1.1em 0.6em; }
    }
    @media (max-width: 480px) {
      .hero-titulo { font-size: 1.25em; }
      h2 { font-size: 1.3em; }
      .ventaja-card, .producto-card { padding: 1em 0.8em; font-size: 0.98em; }
      .ventaja-card h4 { font-size: 1em; }
      .producto-card h3 { font-size: 1em; }
      .producto-card .precio { font-size: 1.05em; }
      .contact-info, .contact-form { padding: 0.7em 0.3em; font-size: 0.97em; }
      #cart-panel { padding: 1em 0.1em; }
      .cart-pay-btn { font-size:1em; padding:0.6em 0; }
      footer { font-size: 0.93em; padding: 1em 0.2em; }
      .explicativo-box { padding: 1.2em 0.6em 1.5em 0.6em; font-size: .97em;}
      .explicativo-box h2 { font-size: 1.15em;}
    }
  </style>
</head>
<body>
<!-- Ventana flotante explicativa -->
<div id="explicativo-flotante">
  <div class="explicativo-box">
    <button class="explicativo-cerrar" id="cerrar-explicativo" aria-label="Cerrar">&times;</button>
    <h2>¿Cómo comprar aquí?</h2>
    <ul>
      <li>Navegá el <b>listado</b> y agregá productos al carrito con el botón <i class="fa fa-cart-plus" style="color:var(--verde-manzana)"></i>.</li>
      <li>Revisá tu pedido en el <b>carrito</b> flotante abajo a la derecha.</li>
      <li>Completá tus datos, dirección y forma de pago.</li>
      <li>¡Enviá el pedido por WhatsApp y te lo llevamos!</li>
    </ul>
    <div style="font-size:0.97em;color:var(--verde-manzana-dark);margin-top:.7em;display:flex;align-items:center;gap:.5em;">
      <i class="fa fa-info-circle" style="color:var(--verde-manzana)"></i>
      <span>Puedes volver a ver esta ayuda recargando la página.</span>
    </div>
  </div>
</div>
<!-- NAVBAR -->
<nav>
  <div class="navbar-container">
    <div class="navbar-logo">
      <img src="img/logo.png" alt="Logo El puesto de Juan" class="logo-sobresale">
      <span class="navbar-title">El puesto de Juan</span>
    </div>
    <button class="navbar-burger" id="navbarBurger" aria-controls="navbarMenu" aria-label="Abrir menú" aria-expanded="false" tabindex="0">
      <span class="navbar-burger-bar"></span>
      <span class="navbar-burger-bar"></span>
      <span class="navbar-burger-bar"></span>
    </button>
    <ul class="navbar-menu" id="navbarMenu">
      <li><a href="#inicio" class="active"><i class="fa fa-home"></i></a></li>
      <li><a href="#productos">Listado</a></li>
      <li><a href="#nosotros">Nosotros</a></li>
      <li><a href="#contacto">Contacto</a></li>
      <li><a href="https://www.facebook.com/Directo-de-la-Chacra-1950140895255116/" target="_blank" rel="noopener" aria-label="Facebook"><i class="fab fa-facebook-square"></i></a></li>
      <li><a href="https://instagram.com/elpuestodejuan" target="_blank" rel="noopener" aria-label="Instagram"><i class="fab fa-instagram"></i></a></li>
    </ul>
  </div>
</nav>
<div class="container">
  <!-- HERO -->
  <section id="inicio">
    <span class="hero-titulo">
      <span class="wavy" id="heroTitulo">Frutas y verduras frescas y de temporada</span>
    </span>
    <p>
      Madrugamos en la huerta para llevar la mejor fruta y verdura directo a tu puerta.
      Nos dedicamos con pasión y alegría a la cosecha diaria, para que disfrutes productos frescos, sanos y de calidad en tu mesa.
      ¡Probá la diferencia!
    </p>
    <img class="hero-image" src="img/portada.png" alt="Frutas y verduras frescas">
  </section>
  <!-- PRODUCTOS -->
  <section id="productos">
    <h2>Listado de productos</h2>
    <div style="background:#fff3cd;color:#856404;padding:1em 1.2em;border:1.5px solid #ffeeba;border-radius:6px;margin-bottom:1.5em;max-width:500px;">
      <i class="fa fa-database" style="color:var(--verde-manzana)"></i>
      Los productos se gestionan <b>desde Google Sheets</b>.<br>
      Puede que por momentos el stock mostrado en la página no esté actualizado.
    </div>
    <div id="galeria-productos"></div>
  </section>
  <!-- NOSOTROS -->
  <section id="nosotros">
    <h2>Nosotros</h2>
    <div class="ventajas-grid">
      <div class="ventaja-card">
        <img src="img/nosotros1.png" alt="Equipo de trabajo">
        <h4>Gente de campo</h4>
        <p>
          Somos un equipo familiar dedicado a producir frutas y verduras frescas y de calidad.
        </p>
      </div>
      <div class="ventaja-card">
        <img src="img/nosotros2.png" alt="Confianza">
        <h4>Venta directa</h4>
        <p>
          Vendemos sin intermediarios, directo de nuestra chacra a tu mesa, siempre al mejor precio.
        </p>
      </div>
      <div class="ventaja-card">
        <img src="img/nosotros3.png" alt="Productos caseros">
        <h4>También casero</h4>
        <p>
          Ofrecemos dulces, conservas y productos hechos en casa, naturales y ricos.
        </p>
      </div>
    </div>
  </section>
  <!-- CONTACTO -->
  <section id="contacto">
    <h2>Contacto</h2>
    <div class="contact-row">
      <div class="contact-info">
        <h3>Datos de contacto</h3>
        <ul>
          <li>
            <i class="fa fa-map-marker-alt" style="color:var(--verde-manzana);font-size:1.4em;"></i>
            <a href="https://www.google.com/maps?q=-34.5272,-56.2772" target="_blank" rel="noopener" style="color:var(--blanco);text-decoration:underline;font-weight:600;">
              Canelones, Uruguay
            </a>
          </li>
          <li>
            <i class="fa fa-phone" style="color:var(--verde-manzana-dark);font-size:1.3em;"></i>
            <a href="tel:094691690" style="color:var(--blanco);text-decoration:underline;font-weight:600;">094 691 690</a>
          </li>
          <li>
            <i class="fa fa-envelope" style="color:var(--verde-manzana);font-size:1.25em;"></i>
            <a href="mailto:info@elpuestodejuan.com" style="color:var(--blanco);text-decoration:underline;font-weight:600;">
              info@elpuestodejuan.com
            </a>
          </li>
          <li>
            <i class="fab fa-whatsapp" style="color:#8afc4d;font-size:1.35em;"></i>
            <a href="https://wa.me/59894691690" target="_blank" rel="noopener" style="color:var(--blanco);text-decoration:none;font-weight:600;">
              WhatsApp
            </a>
          </li>
          <li>
            <i class="fab fa-facebook-square" style="color:#8afc4d;font-size:1.35em;"></i>
            <a href="https://elpuestodjuan.github.io/puestodejuan/" target="_blank" rel="noopener" style="color:var(--blanco);text-decoration:none;font-weight:600;">
              El puesto de Juan
            </a>
          </li>
          <li>
            <i class="fab fa-instagram" style="color:#8afc4d;font-size:1.35em;"></i>
            <a href="https://instagram.com/elpuestodejuan" target="_blank" rel="noopener" style="color:var(--blanco);text-decoration:none;font-weight:600;">
              @elpuestodejuan
            </a>
          </li>
        </ul>
        <div style="margin:18px 0 20px 0;max-width:370px;">
          <a href="https://www.openstreetmap.org/?mlat=-34.5272&mlon=-56.2772#map=15/-34.5272/-56.2772" target="_blank" title="Ver ubicación en OpenStreetMap">
            <iframe
              width="360"
              height="210"
              frameborder="0"
              style="border:1.5px solid var(--verde-manzana-dark);border-radius:8px;box-shadow:0 2px 10px #8afc4d44;"
              src="https://www.openstreetmap.org/export/embed.html?bbox=-56.2872,-34.5372,-56.2672,-34.5172&layer=mapnik&marker=-34.5272,-56.2772"
              allowfullscreen
              loading="lazy"
              referrerpolicy="no-referrer-when-downgrade"
              aria-label="Mapa de Canelones, Uruguay"
            ></iframe>
          </a>
        </div>
      </div>
      <form class="contact-form" action="https://formspree.io/f/mrbkpyol" method="POST" id="contactForm">
        <label for="nombre"><i class="fa fa-user"></i> Nombre</label>
        <input type="text" id="nombre" name="nombre" required autocomplete="off" placeholder="Tu nombre completo">
        <label for="email"><i class="fa fa-envelope"></i> Email</label>
        <input type="email" id="email" name="email" required autocomplete="off" placeholder="Tu email">
        <label for="mensaje"><i class="fa fa-comment"></i> Mensaje</label>
        <textarea id="mensaje" name="mensaje" rows="4" required placeholder="Escribe tu mensaje aquí..."></textarea>
        <button type="submit"><i class="fa fa-paper-plane"></i> Enviar mensaje</button>
        <div id="contact-status"></div>
      </form>
    </div>
  </section>
  <footer>
    © 2025 El puesto de Juan. Todos los derechos reservados.
  </footer>
</div>
<!-- CARRITO flotante avanzado -->
<button id="cart-floating-btn" title="Ver carrito">
  <i class="fa fa-shopping-cart"></i>
  <span id="cart-count">0</span>
</button>
<div id="cart-panel">
  <button id="cart-panel-close" title="Cerrar">&times;</button>
  <h4>Carrito</h4>
  <div id="cart-list"></div>
  <div id="cart-total-row">
    <span>Total:</span>
    <span id="cart-total">$0</span>
  </div>
  <button id="cart-finish-btn">
    <i class="fab fa-whatsapp"></i> Finalizar compra
  </button>
  <form id="cart-panel-form" style="display:none;">
    <div id="pago-step">
      <div style="margin-bottom: 1.1em;">
        <b style="font-size:1.13em;color:var(--verde-manzana);">Total:</b>
        <span id="cart-total-checkout" style="font-size:1.13em;">$0</span>
      </div>
      <div style="margin-bottom:1.1em;">
        <span style="font-weight:700;font-size:1.18em;color:var(--verde-manzana);display:block;margin-bottom:0.5em;">
          ¿Cómo preferís pagar?
        </span>
        <label for="pago-efectivo"><input type="radio" name="pago" id="pago-efectivo" value="Efectivo" required> Efectivo</label>
        <label for="pago-debito"><input type="radio" name="pago" id="pago-debito" value="Débito"> Débito</label>
      </div>
    </div>
    <div id="datos-step" style="display:none;">
      <input type="text" id="cart-client-name" placeholder="Tu nombre" required>
      <input type="text" id="cart-client-location" placeholder="Tu dirección o ubicación" required>
      <small id="location-help" style="color:var(--verde-manzana); font-size:0.96em;display:block;margin-bottom:0.4em;margin-top:0.2em;">
        Es obligatorio indicar tu dirección o ubicación.
      </small>
      <button type="submit" class="cart-pay-btn">
        <i class="fab fa-whatsapp"></i> Enviar pedido
      </button>
    </div>
  </form>
</div>
<script>
  // HERO FRASE PRINCIPAL ALTERNANTE
  const frasesHero = [
    "Frutas y verduras frescas y de temporada",
    "Envío gratis a partir de $300 de compra",
    "Mas de 10 años de experiencia con la gente",
    "Seleccionamos cada producto pensando en usted",
    "Los mejores precios"
  ];
  let idxHero = 0;
  const heroTitulo = document.getElementById('heroTitulo');
  setInterval(() => {
    idxHero = (idxHero + 1) % frasesHero.length;
    heroTitulo.style.opacity = 0;
    setTimeout(() => {
      heroTitulo.textContent = frasesHero[idxHero];
      heroTitulo.style.opacity = 1;
    }, 400);
  }, 6000);

  // Explicativo flotante: solo desaparece si el usuario lo cierra manualmente
  document.addEventListener('DOMContentLoaded', function() {
    var exp = document.getElementById('explicativo-flotante');
    var btn = document.getElementById('cerrar-explicativo');
    if (btn) btn.onclick = function() {
      exp.classList.add('oculto');
      setTimeout(()=>exp.style.display="none",250);
    };
    exp.onclick = function(e) {
      if(e.target === exp) {
        exp.classList.add('oculto');
        setTimeout(()=>exp.style.display="none",250);
      }
    };
  });

  // NAVBAR hamburguesa
  const burger = document.getElementById('navbarBurger');
  const menu = document.getElementById('navbarMenu');
  burger.addEventListener('click', () => {
    const open = burger.classList.toggle('open');
    menu.classList.toggle('open', open);
    burger.setAttribute('aria-expanded', open ? "true" : "false");
    burger.setAttribute('aria-label', open ? "Cerrar menú" : "Abrir menú");
    if(open) menu.querySelector('a').focus();
  });
  document.addEventListener('click', function(e){
    if (window.innerWidth <= 900) {
      if (!menu.contains(e.target) && !burger.contains(e.target)) {
        burger.classList.remove('open');
        menu.classList.remove('open');
        burger.setAttribute('aria-expanded', "false");
      }
    }
  });
  document.addEventListener('keydown', function(e){
    if(e.key === "Escape" && burger.classList.contains('open')) {
      burger.classList.remove('open');
      menu.classList.remove('open');
      burger.setAttribute('aria-expanded', "false");
      burger.focus();
    }
  });
  const menuLinks = menu.querySelectorAll('a');
  menuLinks.forEach(link => {
    link.addEventListener('keydown', function(e){
      if(e.key === 'Tab' && !e.shiftKey && this === menuLinks[menuLinks.length-1] && burger.classList.contains('open')) {
        e.preventDefault();
        burger.focus();
      }
    });
    link.addEventListener('click', function(){
      if(window.innerWidth <= 900) {
        burger.classList.remove('open');
        menu.classList.remove('open');
        burger.setAttribute('aria-expanded', "false");
      }
    });
  });

  // Contacto AJAX
  const contactForm = document.getElementById('contactForm');
  if(contactForm) {
    contactForm.addEventListener('submit', function(ev) {
      ev.preventDefault();
      const status = document.getElementById('contact-status');
      status.textContent = "Enviando...";
      fetch(contactForm.action, {
        method: "POST",
        body: new FormData(contactForm),
        headers: { 'Accept': 'application/json' }
      }).then(response => {
        if(response.ok) {
          status.textContent = "¡Mensaje enviado! Te responderemos pronto.";
          contactForm.reset();
        } else {
          status.textContent = "Ocurrió un error al enviar. Intenta más tarde.";
        }
      }).catch(() => {
        status.textContent = "Ocurrió un error al enviar. Intenta más tarde.";
      });
    });
  }

  // Carrito flotante avanzado
  let cart = [];
  const cartBtn = document.getElementById('cart-floating-btn');
  const cartPanel = document.getElementById('cart-panel');
  const cartClose = document.getElementById('cart-panel-close');
  const cartList = document.getElementById('cart-list');
  const cartCount = document.getElementById('cart-count');
  const cartTotal = document.getElementById('cart-total');
  const cartFinish = document.getElementById('cart-finish-btn');
  const cartForm = document.getElementById('cart-panel-form');
  const clientName = document.getElementById('cart-client-name');
  const clientLocation = document.getElementById('cart-client-location');
  const cartCheckoutTotal = document.getElementById('cart-total-checkout');
  const pagoStep = document.getElementById('pago-step');
  const datosStep = document.getElementById('datos-step');
  function updateCart() {
    cartList.innerHTML = '';
    let total = 0, count = 0;
    cart.forEach((item, idx) => {
      let subtotal = item.precio * item.cantidad;
      total += subtotal;
      count += item.cantidad;
      const row = document.createElement('div');
      row.className = 'item-row';
      row.innerHTML = `
        <span>
          ${item.nombre}
          <small style="color:var(--verde-manzana);">$${item.precio} c/u</small>
          <small style="color:#b6ff8b;">Subt: $${subtotal}</small>
        </span>
        <div>
          <button class="cart-minus" onclick="changeQty(${idx},-1)">-</button>
          <span>${item.cantidad}</span>
          <button class="cart-plus" onclick="changeQty(${idx},1)">+</button>
          <button class="cart-remove" onclick="removeItem(${idx})" title="Quitar"><i class="fa fa-times"></i></button>
        </div>
      `;
      cartList.appendChild(row);
    });
    cartCount.textContent = count;
    cartTotal.textContent = "$" + total;
    if(cartCheckoutTotal) cartCheckoutTotal.textContent = "$" + total;
    cartFinish.style.display = cart.length ? "block" : "none";
    cartForm.style.display = "none";
    datosStep.style.display = "none";
    pagoStep.style.display = "none";
  }
  function addToCart(nombre, precio) {
    precio = Number(precio);
    let found = cart.find(item => item.nombre === nombre);
    if(found) found.cantidad++;
    else cart.push({nombre, precio, cantidad:1});
    updateCart();
    cartBtn.classList.remove("cart-anim");
    void cartBtn.offsetWidth;
    cartBtn.classList.add("cart-anim");
  }
  function changeQty(idx, delta) {
    cart[idx].cantidad += delta;
    if(cart[idx].cantidad <= 0) { cart.splice(idx,1);}
    updateCart();
  }
  function removeItem(idx) {
    cart.splice(idx,1);
    updateCart();
  }
  cartBtn.onclick = () => { cartPanel.style.display = "block"; }
  cartClose.onclick = () => { cartPanel.style.display = "none"; }
  window.addToCart = addToCart;
  window.changeQty = changeQty;
  window.removeItem = removeItem;
  updateCart();

  // Multi-step: pago > datos
  cartFinish.onclick = function() {
    if (!cart.length) return;
    updateCart();
    cartForm.style.display = "block";
    cartFinish.style.display = "none";
    pagoStep.style.display = "block";
    datosStep.style.display = "none";
    cartForm.querySelectorAll('input[name="pago"]').forEach(r=>r.checked=false);
    clientName.value = "";
    clientLocation.value = "";
  };
  cartForm.querySelectorAll('input[name="pago"]').forEach(function(radio) {
    radio.addEventListener('change', function() {
      pagoStep.style.display = "none";
      datosStep.style.display = "block";
      setTimeout(()=>clientName.focus(), 120);
    });
  });

  cartForm.onsubmit = function(e) {
    e.preventDefault();
    if (!cart.length) return;
    let nombre = clientName.value.trim();
    let ubicacion = clientLocation.value.trim();
    let pago = cartForm.querySelector('input[name="pago"]:checked')?.value || '';
    if(!pago) {
      alert("Por favor elegí una forma de pago.");
      return;
    }
    if(!nombre || !ubicacion) {
      alert("Por favor completá tu nombre y dirección o ubicación.");
      return;
    }
    let pedido = `¡Hola! Quiero pedir:\n`;
    cart.forEach(item => {
      pedido += `- ${item.cantidad} x ${item.nombre} ($${item.precio} c/u, Subtotal $${item.precio*item.cantidad})\n`;
    });
    pedido += `Total: $${cart.reduce((t,i)=>t+i.precio*i.cantidad,0)}\n`;
    pedido += `\nMi nombre: ${nombre}\nDirección/Ubicación: ${ubicacion}\nForma de pago: ${pago}\n`;
    const url = "https://wa.me/59894691690?text=" + encodeURIComponent(pedido);
    window.open(url, "_blank");
    cart = [];
    updateCart();
    cartForm.reset();
    cartForm.style.display = "none";
    cartPanel.style.display = "none";
  };

  // Productos desde Google Sheets
  const csvURL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vS-3gs5qzWpdvrI6kGzbqYTXKGIXZvzZdmI_gIvsbthekxpYamA-IP3NdqWgPzmLqFF5U56AN7kA80e/pub?gid=1824323229&single=true&output=csv';
  fetch('https://api.allorigins.win/raw?url=' + encodeURIComponent(csvURL))
    .then(response => response.text())
    .then(csv => {
      const rows = [];
      let insideQuotes = false, row = [], cell = '';
      for (let i = 0; i < csv.length; i++) {
        const char = csv[i], next = csv[i+1];
        if(char === '"' && insideQuotes && next === '"') { cell += '"'; i++; }
        else if(char === '"') insideQuotes = !insideQuotes;
        else if(char === ',' && !insideQuotes) { row.push(cell); cell = ''; }
        else if((char === '\n' || char === '\r') && !insideQuotes) {
          if(cell || row.length>0) { row.push(cell); rows.push(row); cell = ''; row=[]; }
          if(char === '\r' && next === '\n') i++;
        }
        else cell += char;
      }
      if(cell || row.length>0) { row.push(cell); rows.push(row); }
      const headers = rows[0].map(h=>h.trim().toLowerCase());
      const productos = rows.slice(1).map(fila => {
        let obj = {};
        fila.forEach((valor, i) => obj[headers[i]] = valor ? valor.trim() : '');
        return obj;
      });
      renderGaleria(productos);
    })
    .catch(err => {
      document.getElementById('galeria-productos').innerHTML = '<p>No se pudieron cargar los productos.</p>';
      console.error(err);
    });

  function renderGaleria(productos) {
    const galeria = document.getElementById('galeria-productos');
    galeria.innerHTML = '';
    productos.forEach(producto => {
      if (producto.activo && producto.activo.replace(/[\s\u00a0]/g,'').toLowerCase() !== 'sí') return;
      const card = document.createElement('div');
      card.className = 'producto-card';
      card.innerHTML = `
        <img src="${producto.imagen}" alt="${producto.nombre}">
        <h3>${producto.nombre}</h3>
        <span class="precio">$${producto.precio}</span>
        <p class="comentarios">${producto.comentarios || ''}</p>
        <button class="agregar-btn" onclick="addToCart('${producto.nombre}', ${producto.precio})">
          <i class="fa fa-cart-plus"></i>Agregar
        </button>
      `;
      galeria.appendChild(card);
    });
  }
</script>
</body>
</html>